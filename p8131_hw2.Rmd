---
title: "Homework 2"
author: "Yuki Joyama"
date: "2024-02-16"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T, message = F, warning = F)

library(tidyverse)
```

## 1
```{r}
# load data
dose = c(0, 1, 2, 3, 4)
num = c(30, 30, 30, 30, 30)
dead = c(2, 8, 15, 23, 27)
data_1 = data.frame(dose, num, dead)

# visualization 
# plot(data_1$dose, data_1$dead/data_1$num, xlab = 'dose', ylab = 'Proportion dying', cex = 1.5, pch = 19, cex.lab = 1.6, cex.axis = 1.5)

# data prep 
x = data_1$dose
y = data_1$dead
m = data_1$num
resp = cbind(y, m-y)
```

Now, I will fit the model $g(P(dying)) = \alpha + \beta X$ with logit, probit, and complementary log-log links.

```{r}
# fit logistic model, logit 
glm_logit = glm(resp ~ x, family = binomial(link = 'logit'))
summary(glm_logit)

# fit logistic model, probit 
glm_probit = glm(resp ~ x, family = binomial(link = 'probit'))
summary(glm_probit)

# fit logistic model, cloglog 
glm_cloglog = glm(resp ~ x, family = binomial(link = 'cloglog'))
summary(glm_cloglog)
```

### (a)

```{r}
# 95% CI for beta, logit
beta = glm_logit$coefficients[2]
se = sqrt(vcov(glm_logit)[2, 2])
round(beta + c(qnorm(0.025), -qnorm(0.025)) * se, 3)

# 95% CI for beta, probit
beta = glm_probit$coefficients[2]
se = sqrt(vcov(glm_probit)[2, 2])
round(beta + c(qnorm(0.025), -qnorm(0.025)) * se, 3)

# 95% CI for beta, cloglog
beta = glm_cloglog$coefficients[2]
se = sqrt(vcov(glm_cloglog)[2, 2])
round(beta + c(qnorm(0.025), -qnorm(0.025)) * se, 3)
```

```{r}
# p_hat(dying|x = 0.01), logit
predict(glm_logit, newdata = data.frame(x = 0.01), type = 'response')

# p_hat(dying|x = 0.01), probit
predict(glm_probit, newdata = data.frame(x = 0.01), type = 'response')

# p_hat(dying|x = 0.01), cloglog
predict(glm_cloglog, newdata = data.frame(x = 0.01), type = 'response')
```


| Model | Estimate of beta | CI for beta | Deviance | p_hat(dying\|x=0.01) |
|:------|----:|---:|----:|---:|
|logit   | 1.162 |   (0.806-1.517)|  0.379| 0.0901 |
|probit | 0.686|   (0.497-0.876)|  0.314| 0.0853|
|c-log-log  | 0.747|   (0.532-0.961)| 2.231| 0.128 |

### (b)


## 2
```{r}
# load data
amount = seq(10, 90, 5)
offers = c(4, 6, 10, 12, 39, 36, 22, 14, 10, 12, 8, 9, 3, 1, 5, 2, 1)
enrolls = c(0, 2, 4, 2, 12, 14, 10, 7, 5, 5, 3, 5, 2, 0, 4, 2, 1)

data_2 = data.frame(amount, offers, enrolls)

# visualization 
# plot(data_2$amount, data_2$enrolls/data_2$offers, xlab = 'amount', ylab = 'Proportion enrollment', cex = 1.5, pch = 19, cex.lab = 1.6, cex.axis = 1.5)

# data prep 
x = data_2$amount
y = data_2$enrolls
m = data_2$offers + data_2$enrolls
resp = cbind(y, m-y)
```

### (a) How does the model fit the data?
```{r}
# fit logistic model, logit 
glm_logit = glm(resp ~ x, family = binomial(link = 'logit'))
summary(glm_logit)
```

### (b) How do you interpret the relationship between the scholarship amount and enrollment rate? What is 95% CI?
```{r}
# 95% CI for beta, logit
beta = glm_logit$coefficients[2]
se = sqrt(vcov(glm_logit)[2, 2])
round(beta + c(qnorm(0.025), -qnorm(0.025)) * se, 3)
```

### (c) How much scholarship should we provide to get 40% yield rate (the percentage of admitted students who enroll?) What is the 95% CI?
```{r}

```

 