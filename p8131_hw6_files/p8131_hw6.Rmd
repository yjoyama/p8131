---
title: "Homework 6"
author: "Yuki Joyama"
date: "2024-03-24"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = T, message = F, warning = F)

library(tidyverse)
library (nlme)

# setup plot theme
theme_set(
  theme_bw() +
    theme(legend.position = "top")
  )
```

# 1
```{r, out.width="1.0\\linewidth", include=TRUE, fig.align="center", echo=FALSE}
knitr::include_graphics("/Users/yukijoyama/Library/CloudStorage/GoogleDrive-jikeyu1995@gmail.com/My Drive/version_control/MS-biostats/Biostatistical Methods 2/Biostatistical Methods 2/p8131_hw6_files/Screenshot 2024-03-24 at 23.17.48.png")
```

# 2
```{r data}
# data prep
df = read.table("/Users/yukijoyama/Library/CloudStorage/GoogleDrive-jikeyu1995@gmail.com/My Drive/version_control/MS-biostats/Biostatistical Methods 2/Biostatistical Methods 2/p8131_hw6_files/HW6-dental.txt", header = TRUE) |> 
  mutate(
    Gender = as.factor(
      case_when(
        Gender == 0 ~ "girl",
        Gender == 1 ~ "boy"
      )
    )
  )
```

## a
```{r plot}
# grouped data
df_new = groupedData (Distance ~ Age | Child, data = as.data.frame(df))

# create a spaghetti plot 
# boy
df_new |> 
  filter(Gender == "boy") |> 
  ggplot(aes(x = Age, y = Distance, group = Child, color = Child)) + 
  geom_line() + # spaghetti plot
  theme(legend.text = element_text(size = 6)) + # changed legend text size
  labs(
    title = "Boy",
    x = "age",
    y = "distance"
  ) +
  viridis::scale_color_viridis(
    discrete = TRUE
  )

# girl
df_new |> 
  filter(Gender == "girl") |> 
  ggplot(aes(x = Age, y = Distance, group = Child, color = Child)) + 
  geom_line() + # spaghetti plot
  theme(legend.text = element_text(size = 6)) + # changed legend text size
  labs(
    title = "Girl",
    x = "age",
    y = "distance"
  ) +
  viridis::scale_color_viridis(
    discrete = TRUE
  )
```

Distance tends to increase with age, with boys having relatively higher distance values than girls.

## b
The marginal form is 
$$
E(Y_{ij}) = \beta_0+ \beta_1age_{ij}
$$

## c
### Compound symmetry covariance
```{r}
# summary(gls(Distance ~ Gender + Age, data = df, correlation = corCompSymm(form = ~ 1 | Gender), method = "REML"))
```

### Exponential covariance
```{r}

```

### Autoregressive covariance
```{r}

```





